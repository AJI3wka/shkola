function getURLParameter(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function run_geo(e){$.ajax({type:"GET",url:e,dataType:"xml",success:function(e){$(e).find("ip").each(function(){var e=$(this).find("city").text(),i=$(this).find("region").text();if(e!=i)var t=e+", "+i;else t=e;$('<input type="hidden" />').attr({name:"location",class:"location",value:t}).appendTo("form")})}})}function validateEmail(e){return/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i.test(e)}window.downloadFile=function(e){if(window.downloadFile.isChrome||window.downloadFile.isSafari){var i=document.createElement("a");if(i.href=e,void 0!==i.download){var t=e.substring(e.lastIndexOf("/")+1,e.length);i.download=t}if(document.createEvent){var n=document.createEvent("MouseEvents");return n.initEvent("click",!0,!0),i.dispatchEvent(n),!0}}window.open(e+"?download","_self")},window.downloadFile.isChrome=-1<navigator.userAgent.toLowerCase().indexOf("chrome"),window.downloadFile.isSafari=-1<navigator.userAgent.toLowerCase().indexOf("safari"),$(document).ready(function(){$.get("http://ipinfo.io",function(e){geo_url="http://ipgeobase.ru:7020/geo?ip="+e.ip,run_geo(geo_url)},"jsonp"),utm=[],$.each(["utm_source","utm_medium","utm_campaign","utm_term","source_type","source","position_type","position","added","creative","matchtype"],function(e,i){$('<input type="hidden" />').attr({name:i,class:i,value:function(){return null==getURLParameter(i)?"-":getURLParameter(i)}}).appendTo("form")}),$('<input type="hidden" />').attr({name:"url",value:document.location.href}).appendTo("form"),$('<input type="hidden" />').attr({name:"title",value:document.title}).appendTo("form"),$(".map").append('<iframe src="ajax/map.php"></iframe>'),$('input[name="name"]').blur(function(){$(this).val().length<1&&$(this).addClass(" error-input ")}),$('input[name="name"]').focus(function(){$(this).removeClass(" error-input ")}),$('input[name="phone"]').blur(function(){for(var e=$(this).val(),i="",t=0;t<e.length;t++)/[0-9]/.test(e[t])&&(i+=e[t]);i.length<11&&$(this).addClass(" error-input ")}),$('input[name="phone"]').focus(function(){$(this).removeClass("error-input")}),$('input[name="email"]').blur(function(){validateEmail($(this).val())||$(this).addClass("error-input")}),$('input[name="email"]').focus(function(){$(this).removeClass("error-input")}),$(".kyrs,.zapisb,.bonus").click(function(){$(".pop_z#pop_head").arcticmodal()}),$(".dwnlmetod").click(function(){$(".pop_z#pop_metodichka").arcticmodal()}),$(".nav a").click(function(e){if($(this).hasClass("scrollto")){var i=$("#"+$(this).attr("href").split("#")[1]);"./"==$(this).attr("href")&&(i=$(".sec1")),0<i.length&&(e.preventDefault(),$("html, body").animate({scrollTop:i.offset().top-70},500))}}),function(){var e=document.location.hash;if(0<e.length){var i=$(e);0<i.length&&$("html, body").scrollTop(i.offset().top-70)}}();var t=$(".students_works");t.find(".slide-control_gal").find("#arr1l,#arr1r").click(function(){var e=t.find(".shmotki").find(".el.active");e.removeClass("active"),$(this).is("#arr1l")?0<e.prev().length?e.prev().trigger("click"):e.parent().children().last().trigger("click"):0<e.next().length?e.next().trigger("click"):e.parent().children().first().trigger("click")}),t.find(".shmotki").find(".el").click(function(){var e=$(this);e.parent().children().removeClass("active"),e.addClass("active"),t.removeClass("opened");var i=t.find('.item[data-id="'+e.attr("data-id")+'"]');i.parent().children().removeClass("active"),i.addClass("active")}),t.find(".more").click(function(){t.addClass("opened")});var n=$(".sec4");n.find(".slide-control").find("#arr1l_comm,#arr1r_comm").click(function(){var e=n.find(".prepodi").find(".chl.active");e.removeClass("active"),$(this).is("#arr1l_comm")?0<e.prev().length?e.prev().trigger("click"):e.parent().children().last().trigger("click"):0<e.next().length?e.next().trigger("click"):e.parent().children().first().trigger("click")}),n.find(".prepodi").find(".chl").click(function(){var e=$(this);e.parent().children().removeClass("active"),e.addClass("active");var i=n.find('.item[data-id="'+e.attr("data-id")+'"]');i.parent().children().removeClass("active"),i.addClass("active")});var r=$(".sec3");r.find(".slide-control").find("#arr1l_trbll,#arr1r_trbll").click(function(){var e=r.find(".trbl").find(".trouble.active");e.removeClass("active"),$(this).is("#arr1l_trbll")?0<e.prev().length?e.prev().trigger("click"):e.parent().children().last().trigger("click"):0<e.next().length?e.next().trigger("click"):e.parent().children().first().trigger("click")}),r.find(".trbl").find(".trouble").click(function(){var e=$(this);e.parent().children().removeClass("active"),e.addClass("active");var i=r.find('.item[data-id="'+e.attr("data-id")+'"]');i.parent().children().removeClass("active"),i.addClass("active")});var a=$(".sec2");a.find(".slide-control").find("#arr1l_obych,#arr1r_obych").click(function(){var e=a.find(".wrp_step").find(".dota.active");e.removeClass("active"),$(this).is("#arr1l_obych")?0<e.prev().length?e.prev().trigger("click"):e.parent().children().last().trigger("click"):0<e.next().length?e.next().trigger("click"):e.parent().children().first().trigger("click")}),a.find(".wrp_step").find(".dota").click(function(){var e=$(this);e.parent().children().removeClass("active"),e.addClass("active");var i=a.find('.item[data-id="'+e.attr("data-id")+'"]');i.parent().children().removeClass("active"),i.addClass("active")});var l=$(".sec7");l.find(".slide-control").find("#arr1l_ceni,#arr1r_ceni").click(function(){var e=l.find(".kyrsi").find(".ceni_kyrsi.active");e.removeClass("active"),$(this).is("#arr1l_ceni")?0<e.prev().length?e.prev().trigger("click"):e.parent().children().last().trigger("click"):0<e.next().length?e.next().trigger("click"):e.parent().children().first().trigger("click")}),l.find(".kyrsi").find(".ceni_kyrsi").click(function(){var e=$(this);e.parent().children().removeClass("active"),e.addClass("active");var i=l.find('.item[data-id="'+e.attr("data-id")+'"]');i.parent().children().removeClass("active"),i.addClass("active")});var o=$(".sec2");o.find(".trouble").find(".trb_pos").click(function(){var e=$(this);e.parent().children().removeClass("active"),e.addClass("active");var i=o.find('.item[data-id="'+e.attr("data-id")+'"]');i.parent().children().removeClass("active"),i.addClass("active")});$(".sec8").find(".slider-wrap").bxSlider({infiniteLoop:!0,controls:!0,nextSelector:"#arr1r_trbll",prevSelector:"#arr1r_trbll",pager:!1,auto:!1,speed:500,minSlides:1,maxSlides:1,moveSlides:1,onSlideNext:function(e,i,t){},onSlidePrev:function(e,i,t){},onSliderLoad:function(){}}),$(".sec7").find(".slider-wrap").bxSlider({infiniteLoop:!0,controls:!0,nextSelector:"#arr1r_ceni",prevSelector:"#arr1r_ceni",pager:!1,auto:!1,speed:500,minSlides:1,maxSlides:1,moveSlides:1,onSlideNext:function(e,i,t){},onSlidePrev:function(e,i,t){},onSliderLoad:function(){}}),$(".sec4").find(".slider-wrap").bxSlider({infiniteLoop:!0,controls:!0,nextSelector:"#arr1r",prevSelector:"#arr1l",pager:!0,auto:!1,speed:500,minSlides:1,maxSlides:1,moveSlides:1,onSlideNext:function(e,i,t){},onSlidePrev:function(e,i,t){},onSliderLoad:function(){}}),$(".sec3").find(".slider-wrap").bxSlider({infiniteLoop:!0,controls:!0,nextSelector:"#arr1r_trbl",prevSelector:"#arr1l_trbl",pager:!0,auto:!1,speed:500,minSlides:1,maxSlides:1,moveSlides:1,onSlideNext:function(e,i,t){},onSlidePrev:function(e,i,t){},onSliderLoad:function(){}}),$(".sec8").find(".slider-wrap_otz").bxSlider({infiniteLoop:!0,controls:!0,nextSelector:"#arr1r_otz",prevSelector:"#arr1l_otz",pager:!1,auto:!1,speed:500,minSlides:1,maxSlides:1,moveSlides:1,onSlideNext:function(e,i,t){},onSlidePrev:function(e,i,t){},onSliderLoad:function(){}}),$(".sec5").find(".slider-wrap_type").bxSlider({infiniteLoop:!0,controls:!0,nextSelector:"#arr1r_type",prevSelector:"#arr1l_type",pager:!1,auto:!1,speed:500,minSlides:1,maxSlides:1,moveSlides:1,onSlideNext:function(e,i,t){},onSlidePrev:function(e,i,t){},onSliderLoad:function(){}});$(".fancy").fancybox({maxWidth:"90%",maxHeight:"90%",padding:0,helpers:{overlay:{locked:!1},title:null},afterShow:function(){$(".fancybox-wrap").swipe({swipe:function(e,i){"left"===i&&$.fancybox.prev(i),"right"===i&&$.fancybox.next(i)}})}}),$("form").submit(function(e){e.preventDefault();var i=$(this).find('input[name="frmid"]').val();if($(this).find('input[type="text"]').trigger("blur"),$(this).find('input[type="text"]').hasClass("error-input")){var t="";!$(this).find('input[name="name"]').hasClass("error-input")||$(this).find('input[name="phone"]').hasClass("error-input")||$(this).find('input[name="email"]').hasClass("error-input")?!$(this).find('input[name="phone"]').hasClass("error-input")||$(this).find('input[name="name"]').hasClass("error-input")||$(this).find('input[name="email"]').hasClass("error-input")?$(this).find('input[name="phone"]').hasClass("error-input")&&$(this).find('input[name="name"]').hasClass("error-input")&&!$(this).find('input[name="email"]').hasClass("error-input")&&(t="Пожалуйста введите имя и телефон"):t="Пожалуйста введите телефон":t="Пожалуйста введите имя",$(this).find('input[name="name"]').hasClass("error-input")&&!$(this).find('input[name="phone"]').hasClass("error-input")&&$(this).find('input[name="email"]').hasClass("error-input")?t="Пожалуйста введите имя и email":$(this).find('input[name="phone"]').hasClass("error-input")&&!$(this).find('input[name="name"]').hasClass("error-input")&&$(this).find('input[name="email"]').hasClass("error-input")?t="Пожалуйста введите телефон и email":$(this).find('input[name="phone"]').hasClass("error-input")&&$(this).find('input[name="name"]').hasClass("error-input")&&$(this).find('input[name="email"]').hasClass("error-input")&&(t="Пожалуйста введите имя, email и телефон"),$("#form-error-text").html(t),$("#form-error-pop").arcticmodal()}else{var n=$(this).serialize();$(this).find('input[name="event"]').val();$.ajax({type:"POST",url:"ajax/mail.php",data:n,success:function(){$.arcticmodal("close"),$("#okgo").arcticmodal(),"Скачать методичку"==i&&window.downloadFile("metodichka.pdf")}})}})});